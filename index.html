<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">


<meta name='viewport' content='width=device-width,maximum-scale=1.0,initial-scale=1.0,user-scalable=no'/>
<meta name='format-detection' content='telephone=no'/>
<meta name='format-detection' content='address=no'>
<title>Небожители</title>


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Pangolin">

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
	window.Telegram.WebApp.ready();
	window.Telegram.WebApp.expand();
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ZzFX/2.29/ZzFX.micro.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dexie/3.2.4/dexie.min.js"></script>
<script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>


<!-- Для теста во время разработки чтобы стили не кешировались. -->
<!-- Использовать <link rel="stylesheet" type="text/css" href="style.css"> -->
<script>
var cssFile = 'style.css';
var version = new Date().getTime(); // Используем текущее время как версию
$('<link>')
	.attr('rel', 'stylesheet')
	.attr('type', 'text/css')
	.attr('href', cssFile + '?v=' + version)
	.appendTo('head');
</script>


<style>


* {
font-family: Pangolin;
font-weight: normal;
font-size: 14px;
outline: none;
user-select: none;
}

</style>



<style>
        /* Сброс стилей браузера по умолчанию - убрать отступы */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
</style>



<style>

.my-flex-cont {
 display: flex;
  flex-flow: row-reverse wrap-reverse;
 justify-content: center;
align-items: flex-start;
 align-content: flex-start;
 height:100% ;
 width:100%;
}
.my-flex-box {
 margin: 3px;
 padding: 10px 15px 10px 15px;
 flex: 0 1 auto;
 background:rgba(0,0,0,0.6);
 border:1px solid rgba(0,0,0,0.5);
 border-radius:2px;
 box-shadow: 0px 0px 0px 1px rgba(255, 255, 255, 0.2) inset;
 color:#fff;
 font-size:14px;
 color:#fff;
}

</style>


</head>
<body>
<center>


<div style="display:none;">

	<button id="sendButton">Сообение</button>
	<button id="bdButton">бд</button>
	<div id="alert"></div>
	<div id="result-id"></div>
	
	
	<div id='t1' style='height: 40px; width: 40px; position:absolute; top:10px; left:10px; background:#000;'></div>
	<div id='t2' style='height: 40px; width: 40px; position:absolute; top:60px; left:10px; background:#000;'>2</div>

</div>

	
<script>




<!-- const currentUrl = window.location.href; -->
<!-- const userId = new URL(currentUrl).searchParams.get('id'); -->
<!-- document.getElementById('result-id').textContent = `Ваш ID: ${userId || 'не найден'}`; -->


<!-- const targetId = "jf7eded94kdmkjdek9kdw20dekcbq9mmx5sb3owl0sk5na7zvit8cvuer83mvgpemctysps7xm2s"; -->
<!-- const myId = "8xkwM6zo0HzNRzixj19dmcpR5Ncow4ml2s7egp3dqZoB-" + userId; // Уникальный ID для текущего клиента -->

<!-- const peer = new Peer(myId); -->
<!-- let conn; // Объявляем conn глобально -->

<!-- peer.on('open', function(peerID) { -->
	<!-- console.log("Соединение открыто. Ваш ID: " + peerID); -->

	<!-- //подключение -->
	<!-- conn = peer.connect(targetId); -->
	<!-- // Обработка события открытия соединения -->
	<!-- conn.on('open', () => { -->
		<!-- console.log('Соединение открыто'); -->
		<!-- if (conn && conn.open) { -->
			<!-- conn.send('OpenWeb'); -->
		<!-- } else { -->
			<!-- console.error('Соединение не установлено или закрыто'); -->
		<!-- } -->
	<!-- }); -->
	<!-- // Обработка события закрытия соединения -->
	<!-- conn.on('close', () => { -->
		<!-- console.log('Соединение закрыто'); -->
	<!-- }); -->
	<!-- // Обработка ошибок -->
	<!-- conn.on('error', (err) => { -->
		<!-- console.error('Ошибка соединения:', err); -->
	<!-- }); -->
<!-- }); -->

<!-- peer.on('connection', function(connect) { -->

	<!-- connect.on('data', function(data) { -->
	
		<!-- console.log("Получено сообщение: " + data); -->
		<!-- //$("#alert").append("Получено сообщение: " + data + "<br>"); -->
		
		<!-- // Разделяем строку по символу '|' -->
        <!-- const parts = data.split('|'); -->

        <!-- // Проверка, есть ли первая часть и содержит ли она "move" -->
        <!-- if (parts.length > 0 && parts[0] === "move") { -->
            <!-- console.log("Данные перемещения: " + parts[1]); -->
			
			<!-- try { -->
                <!-- // Парсим JSON-строку -->
                <!-- const items = JSON.parse(parts[1]); -->

                <!-- // Создаем div для каждого элемента -->
				<!-- $(".my-flex-cont").empty(); -->
                <!-- items.forEach(item => { -->
                    <!-- const div = $('<div>', { -->
                        <!-- name: "move", -->
                        <!-- xy: item.xy, -->
                        <!-- url: item.url, -->
                        <!-- class: "my-flex-box", -->
                        <!-- text: item.name -->
                    <!-- }); -->
                    <!-- // Вставляем div в #alert -->
                    <!-- $(".my-flex-cont").append(div); -->
                <!-- }); -->
				
				<!-- const div = $('<div>', { -->
                        <!-- name: "npc", -->
                        <!-- class: "my-flex-box", -->
                        <!-- text: "нпс" -->
                    <!-- }); -->
                    <!-- // Вставляем div в #alert -->
                    <!-- $(".my-flex-cont").append(div); -->
				

            <!-- } catch (e) { -->
                <!-- console.error("Ошибка парсинга JSON: ", e); -->
            <!-- } -->
			
        <!-- } -->
		
		
	<!-- }); -->
	
<!-- }); -->







<!-- $('#sendButton').click(function() { -->
	<!-- if (conn && conn.open) { -->
		<!-- // Отправка сообщения (если нужно) -->
		<!-- conn.send('Привет!'); -->
	<!-- } else { -->
		<!-- console.error('Соединение не установлено или закрыто'); -->
	<!-- } -->
<!-- }); -->

<!-- $('#bdButton').click(function() { -->
	<!-- if (conn && conn.open) { -->
		<!-- conn.send('db'); -->
	<!-- } else { -->
		<!-- console.error('Соединение не установлено или закрыто'); -->
	<!-- } -->
<!-- }); -->




</script>






<div id='main' style='padding: 0px 0px 0px 0px; background:#000; width:360px;'>
<div id='content' style='position:relative; padding: 0px 0px 0px 0px;'>


 





<div id='main_pic' class='' style='margin: 0px 0px 0px 0px; background: url(result.png), #000; background-size:100% 100%; padding: 5px 5px 15px 5px; box-sizing:border-box; position:relative; height: 540px; width: 100%; z-index:2; background: url(loc/10.10.jpg) no-repeat; background-size:100% 100%;'>

	
	
	<div id="mus" style='width:40px;
height:40px;
position:absolute;
box-shadow: 0px 0px 3px 1px #000;
background-position:center;
padding:0px;
box-sizing: border-box;
border-radius:2px;
border:1px solid rgba(255,255,255,0.2);
backdrop-filter: sepia(100%); top:10px; left:10px; background:url(file/5206409.png) no-repeat, rgba(245,231,132,0.25); background-size:75% 75%; background-position:center;'></div>
	
	<div id='obj' class=my-flex-cont></div>

</div>



<!-- ЖУРНАЛ -->
<div style='position:relative; width:100%; padding:5px; box-sizing:border-box; background:url(bg_content.png); background-size:100% auto; box-shadow: inset 0px 7px 5px -5px #000;'>
	<div id='journal' style='overflow:hidden; width:100%; height:300px; overflow-y:hidden; position:relative; '></div>
	<div id='' style='position:absolute; top:10px; left:10px; padding:9px; background:#000; color:#fff;'>пример журнала</div>
</div>
<script>
var arr = [
    "Медведь грозно рычит и кидается в вашу сторону.",
    "Злая тварь укусила вас за ногу нанеся 12 урона.",
    "От удара лапы, медведь разрывает вашу кожу. 23 урона.",
    "Заяц убежал на запад.",
    "Медведь пытался наброситься, но вы вовремя увернулись.",
    "Вы бросили камень в медведя, и он отступил, нанеся 5 урона.",
    "Медведь в ярости размахивает лапами, нанося 18 урона.",
    "Вы нашли палку и ударили медведя, нанеся ему 8 урона.",
    "Медведь упал в яму, которую вы подготовили заранее.",
    "Вы использовали маскировку и смогли незаметно отойти от медведя.",
    "Медведь заметил вас и начал преследовать, нанося 10 урона каждые 5 секунд.",
    "Вы нашли куст малины и бросили его медведю, отвлекая его на несколько секунд.",
    "Медведь упал в реку и начал тонуть, но вы не смогли его спасти.",
    "Вы нашли огниво и поджеглись, отпугнув медведя огнем.",
    "Медведь заметил вас и начал рычать, вызывая страх и панику.",
    "Вы нашли капкан и установили его на пути медведя, замедляя его на несколько секунд.",
    "Медведь увидел вас и начал бежать, но вы смогли увернуться в последний момент.",
    "Вы нашли пузырек с ядом и бросили его медведю, нанеся 15 урона.",
    "Медведь увидел вас и начал рычать, вызывая землетрясение.",
    "Вы нашли лук и стрелу и выстрелили в медведя, нанеся 20 урона.",

    // Новые монстры
    "Волк выскочил из кустов и укусил вас за руку, нанеся 14 урона.",
    "Змей-альбинос скрылся в траве, но вы успели увернуться от его ядовитого укуса.",
    "Гигантский паук сплел паутину и начал снимать вас, нанося 10 урона каждые 3 секунды.",
    "Вампир высосал немного вашей крови, нанеся 16 урона и ослабив вас.",
    "Скелет воина поднял меч и ударил вас, нанеся 20 урона.",
    "Дракон взмыл в воздух и выпустил огненный поток, нанеся 30 урона.",
    "Гигантская жаба прыгнула на вас и сжала, нанеся 18 урона.",
    "Призрак проник в ваше тело и начал душить, нанеся 12 урона.",
    "Огненный элементаль выпустил огненный шар, нанеся 25 урона.",
    "Ледяной великан бросил в вас ледяной шип, нанеся 22 урона.",
    "Тролль схватил вас за ногу и ударил о землю, нанеся 15 урона.",
    "Гигантская крыса укусила вас за палец, нанеся 8 урона.",
    "Призрачная лошадь пронзила вас копытом, нанеся 17 урона.",
    "Гигантский скорпион ударил хвостом, нанеся 13 урона.",
    "Летучая мышь укусила вас за ухо, нанеся 6 урона.",
    "Гигантский кабан бросился на вас, нанеся 19 урона.",
    "Призрачная рыба попыталась утащить вас под воду, нанеся 11 урона.",
    "Гигантский краб зажал вас клешнями, нанеся 14 урона.",
    "Ледяной дух выпустил ледяной поток, нанеся 21 урона.",
    "Огненный демон выпустил огненный шар, нанеся 27 урона.",
	
	//
	"Темный рыцарь уклонился от вашей атаки и ответил мощным ударом, ослабив вас на 3 хода.",
    "Древний дракон поднялся в воздух, окутывая вас дымом, который снижает вашу точность на 50%.",
    "Призрачный волшебник наложил на вас проклятье, снижая вашу силу атаки на 20%.",
    "Лесной эльф использовал заклинание лечения, восстановив себе 15 единиц здоровья.",
    "Механический голем заблокировал вашу атаку, отразив 50% урона обратно в вас.",
    "Страж подземелья активировал защитный барьер, увеличив свою броню на 10 единиц.",
    "Волшебный гриб выпустил споры, вызывая у вас галлюцинации и снижая вашу скорость на 2 хода.",
    "Страж времени замедлил вас, увеличив длительность ваших заклинаний на 1 ход.",
    "Призрак унес вашу энергию, снизив вашу ману на 20 единиц.",
    "Ледяной великан создал ледяной щит, который поглощает 15 единиц урона.",
    "Огненный элементаль вызвал землетрясение, снизив вашу скорость передвижения на 3 хода.",
    "Древний скрытень использовал заклинание невидимости, становясь неуязвимым на 2 хода.",
    "Страж света исцелил всех союзников на 10 единиц здоровья.",
    "Темный чародей наложил на вас заклинание ослабления, снижая вашу защиту на 15 единиц.",
    "Лесной дух вызвал бурю, снижая вашу точность и скорость на 2 хода.",
    "Механический страж активировал режим перегрузки, увеличив свою атаку на 20% на 3 хода.",
    "Призрачный рыцарь использовал заклинание ужаса, заставляя вас пропустить 1 ход.",
    "Ледяной волшебник создал ледяной клон, который атакует вас каждый ход.",
    "Огненный демон вызвал огненный шторм, наносящий 10 урона каждый ход в течение 3 ходов.",
    "Древний дракон использовал заклинание огненного дыхания, наносящее 20 урона всем врагам.",
    "Страж подземелья активировал магический барьер, поглощающий 25 единиц урона.",
    "Волшебный гриб выпустил споры, вызывая у вас галлюцинации и снижая вашу скорость на 2 хода.",
    "Темный рыцарь использовал заклинание кровопускания, снижая вашу защиту на 10 единиц.",
    "Лесной эльф вызвал лесную бурю, наносящую 15 урона каждый ход в течение 2 ходов.",
    "Механический голем активировал режим самоуничтожения, наносящий 30 урона всем в радиусе 5 клеток.",
    "Страж времени замедлил вас, увеличив длительность ваших заклинаний на 1 ход.",
    "Призрак унес вашу энергию, снизив вашу ману на 20 единиц.",
    "Ледяной великан создал ледяной щит, который поглощает 15 единиц урона.",
    "Огненный элементаль вызвал землетрясение, снизив вашу скорость передвижения на 3 хода.",
    "Древний скрытень использовал заклинание невидимости, становясь неуязвимым на 2 хода.",
    "Страж света исцелил всех союзников на 10 единиц здоровья.",
    "Темный чародей наложил на вас заклинание ослабления, снижая вашу защиту на 15 единиц.",
    "Лесной дух вызвал бурю, снижая вашу точность и скорость на 2 хода.",
    "Механический страж активировал режим перегрузки, увеличив свою атаку на 20% на 3 хода.",
    "Призрачный рыцарь использовал заклинание ужаса, заставляя вас пропустить 1 ход.",
    "Ледяной волшебник создал ледяной клон, который атакует вас каждый ход.",
    "Огненный демон вызвал огненный шторм, наносящий 10 урона каждый ход в течение 3 ходов.",
    "Древний дракон использовал заклинание огненного дыхания, наносящее 20 урона всем врагам.",
    "Страж подземелья активировал магический барьер, поглощающий 25 единиц урона.",
    "Волшебный гриб выпустил споры, вызывая у вас галлюцинации и снижая вашу скорость на 2 хода.",
    "Темный рыцарь использовал заклинание кровопускания, снижая вашу защиту на 10 единиц.",
    "Лесной эльф вызвал лесную бурю, наносящую 15 урона каждый ход в течение 2 ходов.",
    "Механический голем активировал режим самоуничтожения, наносящий 30 урона всем в радиусе 5 клеток.",
    "Страж времени замедлил вас, увеличив длительность ваших заклинаний на 1 ход.",
    "Призрак унес вашу энергию, снизив вашу ману на 20 единиц.",
    "Ледяной великан создал ледяной щит, который поглощает 15 единиц урона.",
    "Огненный элементаль вызвал землетрясение, снизив вашу скорость передвижения на 3 хода.",
    "Древний скрытень использовал заклинание невидимости, становясь неуязвимым на 2 хода.",
    "Страж света исцелил всех союзников на 10 единиц здоровья.",
    "Темный чародей наложил на вас заклинание ослабления, снижая вашу защиту на 15 единиц.",
    "Лесной дух вызвал бурю, снижая вашу точность и скорость на 2 хода.",
    "Механический страж активировал режим перегрузки, увеличив свою атаку на 20% на 3 хода.",
    "Призрачный рыцарь использовал заклинание ужаса, заставляя вас пропустить 1 ход.",
    "Ледяной волшебник создал ледяной клон, который атакует вас каждый ход.",
    "Огненный демон вызвал огненный шторм, наносящий 10 урона каждый ход в течение 3 ходов.",
    "Древний дракон использовал заклинание огненного дыхания, наносящее 20 урона всем врагам.",
    "Страж подземелья активировал магический барьер, поглощающий 25 единиц урона.",
    "Волшебный гриб выпустил споры, вызывая у вас галлюцинации и снижая вашу скорость на 2 хода.",
    "Темный рыцарь использовал заклинание кровопускания, снижая вашу защиту на 10 единиц.",
    "Лесной эльф вызвал лесную бурю, наносящую 15 урона каждый ход в течение 2 ходов.",
    "Механический голем активировал режим самоуничтожения, наносящий 30 урона всем в радиусе 5 клеток.",
    "Страж времени замедлил вас, увеличив длительность ваших заклинаний на 1 ход.",
    "Призрак унес вашу энергию, снизив вашу ману на 20 единиц.",
    "Ледяной великан создал ледяной щит, который поглощает 15 единиц урона.",
    "Огненный элементаль вызвал землетрясение, снизив вашу скорость передвижения на 3 хода.",
    "Древний скрытень использовал заклинание невидимости, становясь неуязвимым на 2 хода.",
    "Страж света исцелил всех союзников на 10 единиц здоровья.",
    "Темный чародей наложил на вас заклинание ослабления, снижая вашу защиту на 15 единиц.",
    "Лесной дух вызвал бурю, снижая вашу точность и скорость на 2 хода.",
    "Механический страж активировал режим перегрузки, увеличив свою атаку на 20% на 3 хода.",
    "Призрачный рыцарь использовал заклинание ужаса, заставляя вас пропустить 1 ход.",
    "Ледяной волшебник создал ледяной клон, который атакует вас каждый ход.",
    "Огненный демон вызвал огненный шторм, наносящий 10 урона каждый ход в течение 3 ходов.",
    "Древний дракон использовал заклинание огненного дыхания, наносящее 20 урона всем врагам.",
    "Страж подземелья активировал магический барьер, поглощающий 25 единиц урона.",
    "Волшебный гриб выпустил споры, вызывая у вас галлюцинации и снижая вашу скорость на 2 хода.",
    "Темный рыцарь использовал заклинание кровопускания, снижая вашу защиту на 10 единиц.",
    "Лесной эльф вызвал лесную бурю, наносящую 15 урона каждый ход в течение 2 ходов.",
    "Механический голем активировал режим самоуничтожения, наносящий 30 урона всем в радиусе 5 клеток.",
    "Страж времени замедлил вас, увеличив длительность ваших заклинаний на 1 ход.",
    "Призрак унес вашу энергию, снизив вашу ману на 20 единиц.",
    "Ледяной великан создал ледяной щит, который поглощает 15 единиц урона.",
    "Огненный элементаль вызвал землетрясение, снизив вашу скорость передвижения на 3 хода.",
    "Древний скрытень использовал заклинание невидимости, становясь неуязвимым на 2 хода.",
    "Страж света исцелил всех союзников на 10 единиц здоровья.",
    "Темный чародей наложил на вас заклинание ослабления, снижая вашу защиту на 15 единиц.",
    "Лесной дух вызвал бурю, снижая вашу точность и скорость на 2 хода.",
    "Механический страж активировал режим перегрузки, увеличив свою атаку на 20% на 3 хода.",
    "Призрачный рыцарь использовал заклинание ужаса, заставляя вас пропустить 1 ход.",
    "Ледяной волшебник создал ледяной клон, который атакует вас каждый ход.",
    "Огненный демон вызвал огненный шторм, наносящий 10 урона каждый ход в течение 3 ходов.",
    "Древний дракон использовал заклинание огненного дыхания, наносящее 20 урона всем врагам.",
    "Страж подземелья активировал магический барьер, поглощающий 25 единиц урона.",
    "Волшебный гриб выпустил споры, вызывая у вас галлюцинации и снижая вашу скорость на 2 хода.",
    "Темный рыцарь использовал заклинание кровопускания, снижая вашу защиту на 10 единиц.",
    "Лесной эльф вызвал лесную бурю, наносящую 15 урона каждый ход в течение 2 ходов.",
    "Механический голем активировал режим самоуничтожения, наносящий 30 урона всем в радиусе 5 клеток.",
    "Страж времени замедлил вас, увеличив длительность ваших заклинаний на 1 ход.",
    "Призрак унес вашу энергию, снизив вашу ману на 20 единиц.",
    "Ледяной великан создал ледяной щит, который поглощает 15 единиц урона.",
    "Огненный элементаль вызвал землетрясение, снизив вашу скорость передвижения на 3 хода.",
    "Древний скрытень использовал заклинание невидимости, становясь неуязвимым на 2 хода.",
    "Страж света исцелил всех союзников на 10 единиц здоровья.",
    "Темный чародей наложил на вас заклинание ослабления, снижая вашу защиту на 15 единиц.",
    "Лесной дух вызвал бурю, снижая вашу точность и скорость на 2 хода."
];
setInterval(function() {
  var randomIndex = Math.floor(Math.random() * arr.length);
  var randomText = arr[randomIndex];
  $("#journal").prepend("<div class='text_jrn' style='font-size:15px; text-align:center; color:#000; line-height: 0.85; margin-bottom:5px;'>" + randomText + "</div>");
}, 1000);

// Удаляем старые элементы, если их больше 3
setInterval(function() {
  var children = $("#journal").children();
  if (children.length > 20) {
    children.slice(20).remove();
  }
}, 500);
</script>



</div><!-- content -->
</div><!-- main -->



<script>







$('#t1').click(function() {

	$('#main_pic').html('<div style="height: 100%; width: 100%; position:absolute; top:0px; left:0px; background:url(rty.webp) repeat, rgba(0,0,0, 0.6);"></div>');

	$('#main_pic').append('<div style="position:absolute; top:10px; left:10px; right:10px; height:180px; border-radius:4px; border:1px solid #000; background:url(Screenshot_2.png), #000; background-size:100% 100%; background-position:center;"></div>  </div>');
	
});


//$(document).on('click', 'div[name="npc"]', function() {
$('#t2').click(function() {
	$('#main_pic').html('<div style="height: 100%; width: 100%; position:absolute; top:0px; left:0px; background:url(rty.webp) repeat, rgba(0,0,0, 0.6);"></div>');

	//$('#main_pic').append('<div style="position:absolute; top:10px; left:10px; right:10px; height:180px; border-radius:4px; border:1px solid #000; background:url(Screenshot_2.png), #000; background-size:100% 100%; background-position:center;"></div>  </div>');
	
	$('#main_pic').append('<div style="position: absolute; top: 10px; left: 10px; right: 10px; border: 0px solid red; padding: 0;"><div style="float: left; width: 70px; height: 70px; margin-right: 6px; margin-top: 1px; background:url(Screenshot_2.png), #000; background-size:100% 100%; border: 1px solid #000; box-shadow: 0px 0px 2px 0px rgba(255, 255, 255, 0.8); border-radius:2px;"></div><p style="color: #fff; margin: 0; padding: 0; line-height: 1.05; align: left; text-align: left;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>');
	
	
	
});













var obj = ["яблоня", "волк", "медведь", "демон", "гриб", "мухомор", "олень", "пень", "лужа", "дерево", "ведро", "колодец", "ящерица", "яйцо", "нора", "кристаллический обелиск",
    "феникс",
    "тролль",
    "зелье сновидений",
    "древний манускрипт",
    "магический амулет",
    "старая библиотека",
    "руины замка",
    "драконье яйцо",
    "светлячок",
    "северное сияние",
    "чудесный фонарь",
    "кукла из трав",
    "гривастый единорог",
    "шлем воина",
    "старый корабль",
    "крепость изобилия",
    "чертоги викингов",
    "лесной дух",
    "волшебная арфа",
    "гномий кузнец",
    "песчаная буря",
    "призрачный всадник",
    "вилы ночи",
    "медальон времени",
    "чаша бессмертия",
    "грибной лес",
    "туманное озеро",
    "чародейская палочка",
    "разрушенный мост",
    "хрустальный шар",
    "цветок жизни",
    "зеркало желаний",
    "дерево-охотник",
    "шаманский тотем",
    "волшебный портфель",
    "спящий дракон",
    "портал в другие миры",
    "забытый алтарь",
    "костяной скелет",
    "хрустальная сфера",
    "живая статуя",
    "светящееся растение"];



var obj_info = {
    "яблоня": "Яблоня — это великолепное дерево, которое весной покрывается нежными белыми и розовыми цветами, наполняя воздух сладким ароматом. Осенью на её ветвях созревают сочные и ароматные яблоки, которые радуют глаз и становятся основой для множества вкусных блюд. Яблоня символизирует изобилие и плодородие, а её плоды обладают множеством полезных свойств. В мире игры это дерево может стать источником питания, лечения и вдохновения для персонажей.",
    "волк": "12345"
};




$(document).on('click', 'button[name="obj"]', function() {

	$('#main_pic').append('<div id="inf1" style="height: 100%; width: 100%; position:absolute; top:0px; left:0px; background: rgba(0,0,0, 0.8);"></div>');
	
	
	
	
	$('#main_pic').append('<div id="inf2" style="position: absolute; top: 10px; left: 10px; right: 10px; border: 0px solid red; padding: 0;"><p style="color: #fff; margin: 0; padding: 0; line-height: 1.05;">пометка - тут изображение объекта, статы существа (здоров, мана, сила тд) и описание, напр для яблоня: Яблоня — скромное дерево с раскидистыми ветвями, усыпанными весной белыми цветами. Летом её листья шепчутся на ветру, а осенью она радует глаз яркими яблоками, готовыми к сбору. Это место, где можно отдохнуть в тени и насладиться простыми радостями природы.</p></div>');

	
	<!-- // Получаем имя объекта из кнопки (предполагаем, что имя кнопки соответствует ключу в obj_info) -->
    <!-- var objName = $(this).text(); // или используйте атрибут name или другой способ, чтобы получить название -->
    <!-- // Получаем описание из obj_info -->
    <!-- var description = obj_info[objName]; -->
    <!-- // Создаем новый элемент и вставляем описание -->
    <!-- var infoDiv = $('<div id="inf2" style="position: absolute; top: 10px; left: 10px; right: 10px; border: 0px solid red; padding: 0;">' + -->
                    <!-- '<p style="color: #fff; margin: 0; padding: 0; line-height: 1.05;">' + description + '</p>' + -->
                    <!-- '</div>'); -->
    <!-- // Добавляем элемент в #main_pic -->
    <!-- $('#main_pic').append(infoDiv); -->
	
	
	$('#main_pic').append('<div id="inf3" style="position: absolute; bottom: 60px; left:50%; transform: translateX(-50%); color:#d6d1ce; font-size:13px; line-height: 0.89;">пометка - тут будут кнопки для взаимодействий и атаки для сражения</div>');
	
	$('#main_pic').append("<div id='close' style='margin: 3px; padding: 10px 15px 10px 15px; background:rgba(0,0,0,0.9); border:1px solid rgba(0,0,0,0.5); border-radius:4px; box-shadow: 0px 0px 0px 1px rgba(255, 255, 255, 0.35) inset; color:#fff; font-size:14px; color:#fff; position:absolute; bottom:10px; left:50%; transform: translateX(-50%);'>закрыть</div>");
});

//закрыть наложенные окна
$(document).on('click', '#close', function() {
    $('#close').remove();
    $('#inf1').remove();
    $('#inf2').remove();
    $('#inf3').remove();
});








// оффлайн перемещение

// Создаем div для каждого элемента
$(".my-flex-cont").empty();

// Текущая локация игрока
var my_loc = "10.10";

// Доступные пути
var loc_arr = ["10.10", "10.11", "10.12", "10.13", "10.14", "10.6", "10.7", "10.8", "10.9", "11.10", "11.11", "11.12", "11.13", "11.14", "11.6", "11.7", "11.8", "11.9", "12.10", "12.11", "12.12", "12.13", "12.14", "12.6", "12.8", "12.9", "2.6", "3.6", "4.6", "5.6", "6.6", "7.10", "7.12", "7.6", "7.7", "7.8", "7.9", "8.10", "8.12", "8.13", "8.6", "8.7", "8.8", "8.9", "9.10", "9.11", "9.12", "9.13", "9.14", "9.6", "9.7", "9.8", "9.9"];

// Функция для получения координат
function getCoordinates(loc) {
    return loc.split('.').map(Number);
}

// Функция для проверки доступности пути
function isPathAvailable(x, y) {
    return loc_arr.includes(`${x}.${y}`);
}

// Функция для обновления интерфейса после перемещения
function updatePaths() {
    $(".my-flex-cont").empty();
    var [currentX, currentY] = getCoordinates(my_loc);
    var availablePaths = [];

    if (isPathAvailable(currentX - 1, currentY)) availablePaths.push(`${currentX - 1}.${currentY}`);
    if (isPathAvailable(currentX + 1, currentY)) availablePaths.push(`${currentX + 1}.${currentY}`);
    if (isPathAvailable(currentX, currentY - 1)) availablePaths.push(`${currentX}.${currentY - 1}`);
    if (isPathAvailable(currentX, currentY + 1)) availablePaths.push(`${currentX}.${currentY + 1}`);

    availablePaths.forEach(path => {
        const [x, y] = getCoordinates(path);
        const direction = x > currentX ? 'север' : x < currentX ? 'юг' : y > currentY ? 'восток' : 'запад';

        const button = $('<button>', {
            class: "my-flex-box",
            text: `${direction}`,
            click: function() {
                my_loc = path;
                $(".my-flex-cont").empty();
                updatePaths();
            }
        });

        $(".my-flex-cont").append(button);
		
    });
	
	$('#main_pic').css('background-image', `url("loc/${my_loc}.jpg")`);
		
	//шаги
	var audio = new Audio("file/shagi-begom-po-lesu2.mp3");
	audio.volume = 1;
	audio.play();
	
	
	
	
	
            
	// объекты
	// Получаем уникальные элементы
	var uniqueItems = Array.from(new Set(obj));

	// Выбираем случайное количество элементов от 2 до минимального значения между 5 и количеством уникальных элементов
	var count = Math.min(Math.floor(Math.random() * 4) + 2, uniqueItems.length);

	// Выбираем случайные элементы из массива
	var selectedItems = new Set();
	while (selectedItems.size < count) {
		var randomIndex = Math.floor(Math.random() * uniqueItems.length);
		var item = uniqueItems[randomIndex];
		selectedItems.add(item);
	}

	// Создаем кнопки и добавляем их в контейнер
	selectedItems.forEach(function(item) {
		var button = $('<button class="my-flex-box" name="obj">').text(item);
		$('.my-flex-cont').append(button);
	});    

                
            
	
}

// Инициализация интерфейса
updatePaths();









//перемещение
$(document).on('click', 'div[name="move"]', function() {

	
	//DB("loc");
	
	
	//saveImgAndReadDB("loc");
	//exp_add_move();
	
	const move = $(this).attr("xy");
	console.log('move - ' + move);
	
	const newBackgroundUrl = $(this).attr('url');
	// Меняем фоновое изображение элемента с id="main_pic"
	$('#main_pic').css('background-image', `url('${newBackgroundUrl}')`);
	
	if (conn && conn.open) {
		conn.send('move|' + move);
	} else {
		console.error('Соединение не установлено или закрыто');
	}
	
	
	
	var audio = new Audio("file/shagi-begom-po-lesu2.mp3");
	audio.volume = 1;
	audio.play();
	

});



// музыка
$(document).ready(function() {
	let isPlaying = false;
	let currentAudio = '';
	let audioPlayer = new Audio();

	function getRandomAudio() {
		let audioNumber;
		do {
			audioNumber = Math.floor(Math.random() * 5) + 1;
		} while (audioNumber.toString() === currentAudio);
		return audioNumber.toString() + '.mp3';
	}

	function playAudio() {
		let audioFile = getRandomAudio();
		currentAudio = audioFile.split('.')[0];
		audioPlayer.src = 'file/m1/' + audioFile;
		audioPlayer.load();
		audioPlayer.volume = 0.35;
		audioPlayer.play();
		isPlaying = true;
	}

	function stopAudio() {
		audioPlayer.pause();
		audioPlayer.currentTime = 0;
		isPlaying = false;
	}

	$(document).on('click', '#mus', function() {
		if (isPlaying) {
			stopAudio();
		} else {
			playAudio();
		}
	});

	audioPlayer.addEventListener('ended', function() {
		playAudio();
	});
	
});

// выполнить действие только один раз при нажатии на элемент с классом my-flex-box, можно использовать флаг 
$(document).ready(function() {
    var clicked = false; // Флаг для отслеживания состояния

    $('.my-flex-box').one('click', function() {
        if (!clicked) {
            $('#mus').click(); // Выполняем действие
            clicked = true; // Устанавливаем флаг в true, чтобы предотвратить повторное выполнение
        }
    });
});
























</script>

















<iframe
    src="https://sites.google.com/view/testjsiframe/"
    width="100%"
    height="500px"
    style="border: none;"
    title="Test JS Iframe"
></iframe>






</center>
</body>
</html>
